\chapter{Discontinuous Galerkin Spectral Element Method} \label{chapter:spectral_element_method} 
We will use the discontinuous Galerkin spectral element method to solve this problem. This method is
part of the broader spectral methods, with elements from finite-element methods. This method has the
exponential convergence of spectral methods, and the ability to model difficult geometries of
finite-element methods. This method and a way to efficiently translate it to computer code is
described in~\cite{Kopriva2009}. We use this method to solve the 2D wave equation. The main problem
showcased through this work depicts a wave moving diagonally through a square domain.

\section{Spectral approximation} \label{section:spectral_element_method:spectral_approximation}
% Legendre polynomials, both forms
% Polynomial interpolation

Spectral methods, as described by Gotlieb and Orszag~\cite{Gottlieb1977}, model functions as sums of
weighed orthogonal polynomials. $\phi_n(x)$ is the polynomial of degree $n$, and $a_n$ is the weight
of said polynomial. The weights make up the spectrum of the solution.

\begin{equation} \label{equ:infinite_sum}
    \begin{split}
        f(x) & = \sum_{n = 0}^{\infty }a_n \phi_n(x)
    \end{split}
\end{equation}

Since it is impractical to sum an infinite number of polynomials on a computer, the sum is truncated
to a polynomial order $N$. This becomes the polynomial order of the approximation. The truncated
part becomes $\tau$, the truncation error.

\begin{equation} \label{equ:truncated_sum}
    \begin{split}
        f(x) & = \sum_{n = 0}^{\infty }a_n \phi_n(x) \\
        & = \sum_{n = 0}^{N}a_n \phi_n(x) + \sum_{n = N + 1}^{\infty }a_n \phi_n(x) \\
        & = \sum_{n = 0}^{N}a_n \phi_n(x) + \tau \\
        & \approx \sum_{n = 0}^{N}a_n \phi_n(x)
    \end{split}
\end{equation}

Since we discard part of the spectrum is discarded, it is important that the most important part of
the spectrum is in the lower order polynomials. We want the weights to decay as fast as possible.
This will be a characteristic of the polynomials we choose. For example, Fourier series, Legendre
polynomials and Chebyshev polynomials have been proved~\cite{Kopriva2009} to have exponentially
decaying coefficient, giving them spectral accuracy.

\subsection{Basis functions} \label{section:spectral_element_method:spectral_approximation:basis_functions}
Polynomials used in spectral methods need to be orthogonal in the studied domain. For orthogonal
functions in the domain $[a, b]$, we have:

\begin{equation} \label{equ:orthogonality}
	\int_{a}^{b}\phi_i(x) \phi_j(x)dx = C_i \delta_{ij}
\end{equation}

With $C_i$ being a constant, and $\delta_{ij}$ being the Kronecker delta, defined as such:

\begin{equation} \label{equ:kronecker}
	\delta _{ij} = \left\{ \begin{matrix}
                    1, & if \:\: i = j,\\ 
                    0, & if \:\: i \neq j.
                    \end{matrix} \right.
\end{equation}

The inner product $V = L^2 \left( a, b \right)$, with $V$ being a vector space over $\mathbb{R}$ and
$f \left( x \right)$ and $g \left( x \right)$ being two continuous function in $\left[ a, b
\right]$, is:

\begin{equation}
    \left( f, g \right) = \int_{a}^{b}f(x)g(x)dx. 
\end{equation}

We can therefore rewrite Equation~\ref{equ:orthogonality} in inner product form:

\begin{equation}
	\left( \phi_i, \phi_j \right) = \int_{a}^{b}\phi_i(x) \phi_j(x)dx = C_i \delta_{ij}.
\end{equation}

The high-order orthogonal polynomials we use have associated weights $w$:

\begin{equation}
	\left ( \phi_i, \phi_j \right ) = \int_a^b \phi_i(x)\phi_j(x)w(x)dx = D_{ij}\delta_{ij},
\end{equation}

We added $w(x)$, the weight function ensuring the orthogonality of the polynomials. $D_{ij}$ is a
constant. 

Fourier series can be used for periodic problems. As for non-periodic problems, Legendre polynomials
and Chebyshev polynomials fit these criteria. Legendre polynomial have a a weight function of $w(x)
= 1$, which simplifies computations. We will therefore use the Legendre polynomials.

\begin{figure}[H]
	\centering
	\includesvg[width=0.8\textwidth]{Chapter_spectral_element_method/media/polynomials}
	\caption{Legendre polynomials: The first 6 Legendre polynomials.}
	\label{fig:polynomials}
\end{figure}

The Legendre polynomials were discovered by Adrien-Marie Legendre in 1782. With their associated
weights $w(x) = 1$ and in the interval $\left[ -1, 1 \right]$, the polynomials are orthogonal. The
Legendre polynomials $L_k \left( x \right)$ of degree $k$ therefore have the property:

\begin{equation}
	\int_{-1}^{1}L_{k_1}(x) L_{k_2}(x) dx = 0, \quad if \:\: k_1 \neq k_2. 
\end{equation}

The Legendre polynomials can be generated using a three-term recursive formula. Knowing that the
first two polynomials are $L_0 \left( x \right) = 1$ and $L_1 \left( x \right) = x$, all subsequent
polynomials can be generated.

\begin{equation} \label{equ:three_terms}
	L_{k + 1}(x) = \frac{2k + 1}{k + 1}xL_k(x) - \frac{k}{k + 1}L_{k - 1}(x).
\end{equation}

These polynomials will help us solve integrals using Gauss quadrature. For an interval $\left[ -1, 1
\right]$, the Gauss quadrature is:

\begin{equation}
	\int_{-1}^{1}f(x)dx \approx \sum_{i = 0}^{N}w_i f(x_i). 
\end{equation}

The points $x_i$ used for the quadrature are the Gauss quadrature points, or collocation points.
Using the roots of the (N + 1)\textsuperscript{th} Legendre polynomial, the quadrature is exact for
polynomials of degree $\leq 2 N + 1$. This is the \textit{Gauss-Legendre quadrature rule}. We use
the roots of the (N + 1)\textsuperscript{th} Legendre polynomial to get the positions $x_i$ and
weights $w_i$.

\begin{gather}
	x_i = roots \:\: of \:\: L_{N + 1}(x), \quad i = 0, ..., N, \\
	w_i = \frac{2}{(1-x_i^2)\left [ L'_{N + 1}(x_i) \right ]^2}.
\end{gather}

\subsection{Polynomial interpolation} \label{section:spectral_element_method:spectral_approximation:polynomial_interpolation}
Polynomial interpolation interpolates data along a polynomial passing through known points. The
polynomial has an order equal to the number of points. In this work we use Lagrange integrating
polynomials $l_j$ of degree N.

\begin{equation}
	l_j(x) = \prod_{\substack{i = 0 \\ i \neq j}}^{N}\frac{x- x_i}{x_j - x_i},
\end{equation}

At each collocation point $x_i$ only one of the integrating polynomials has the value 1, the others
having a value of 0. This mimics the Kronecker delta $\delta_{ij}$.

\begin{equation}
	l_j(x_i) = \delta_{ij} = \left\{\begin{matrix}
	1, \quad i = j\\ 
	0, \quad i \neq j,
	\end{matrix}\right.
\end{equation}

The following figure displays the interpolating polynomials of degree 6:

\begin{figure}[H]
	\centering
	\includesvg[width=0.8\textwidth]{Chapter_spectral_element_method/media/interpolants}
	\caption{Polynomial interpolation: The Lagrange integrating polynomials of degree 6.}
	\label{fig:interpolants}
\end{figure}


With this, we can interpolate a function $p_N \left( x \right)$ of degree N:

\begin{equation}
	p_N(x) = \sum_{j = 0}^{N}p(x_j)l_j(x).
\end{equation}


\section{DG-SEM} \label{section:spectral_element_method:dg_sem}

~\cite{Patera1984}

\section{Equation} \label{section:spectral_element_method:equation}

\section{Implementation} \label{section:spectral_element_method:implementation}
% Talk about the flux computation, possible race conditions
